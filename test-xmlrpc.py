#!/usr/bin/env python
#
# Copyright (C) 2015 Red Hat, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#         http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#


import xmlrpclib

DATA='''<?xml version="1.0" encoding="UTF-8"?>
<methodCall>
  <methodName>CGImport</methodName>
  <params>
    <param>
      <value>
        <struct>
          <member>
            <name>output</name>
            <value>
              <array>
                <data>
                  <value>
                    <struct>
                      <member>
                        <name>checksum_type</name>
                        <value>
                          <string>MD5</string>
                        </value>
                      </member>
                      <member>
                        <name>filename</name>
                        <value>
                          <string>bar-1.1.pom</string>
                        </value>
                      </member>
                      <member>
                        <name>buildroot_id</name>
                        <value>
                          <int>1</int>
                        </value>
                      </member>
                      <member>
                        <name>checksum</name>
                        <value>
                          <string>6c287978b648b9c6faaff69f0f4cd826</string>
                        </value>
                      </member>
                      <member>
                        <name>filesize</name>
                        <value>
                          <int>193</int>
                        </value>
                      </member>
                      <member>
                        <name>arch</name>
                        <value>
                          <string>noarch</string>
                        </value>
                      </member>
                      <member>
                        <name>type</name>
                        <value>
                          <string>pom</string>
                        </value>
                      </member>
                    </struct>
                  </value>
                </data>
              </array>
            </value>
          </member>
          <member>
            <name>build</name>
            <value>
              <struct>
                <member>
                  <name>start_time</name>
                  <value>
                    <string>1474061569154.00000</string>
                  </value>
                </member>
                <member>
                  <name>release</name>
                  <value>
                    <string>1</string>
                  </value>
                </member>
                <member>
                  <name>extra</name>
                  <value>
                    <struct>
                      <member>
                        <name>maven</name>
                        <value>
                          <struct>
                            <member>
                              <name>group_id</name>
                              <value>
                                <string>org.foo</string>
                              </value>
                            </member>
                            <member>
                              <name>artifact_id</name>
                              <value>
                                <string>bar</string>
                              </value>
                            </member>
                            <member>
                              <name>version</name>
                              <value>
                                <string>1.1</string>
                              </value>
                            </member>
                          </struct>
                        </value>
                      </member>
                    </struct>
                  </value>
                </member>
                <member>
                  <name>name</name>
                  <value>
                    <string>org.foo-bar</string>
                  </value>
                </member>
                <member>
                  <name>end_time</name>
                  <value>
                    <string>1474061612354.00000</string>
                  </value>
                </member>
                <member>
                  <name>source</name>
                  <value>
                    <struct>
                      <member>
                        <name>url</name>
                        <value>
                          <string>http://builder.foo.com</string>
                        </value>
                      </member>
                      <member>
                        <name>revision</name>
                        <value>
                          <string>1.0</string>
                        </value>
                      </member>
                    </struct>
                  </value>
                </member>
                <member>
                  <name>type</name>
                  <value>
                    <string>maven</string>
                  </value>
                </member>
                <member>
                  <name>version</name>
                  <value>
                    <string>1.1</string>
                  </value>
                </member>
              </struct>
            </value>
          </member>
          <member>
            <name>buildroots</name>
            <value>
              <array>
                <data>
                  <value>
                    <struct>
                      <member>
                        <name>container</name>
                        <value>
                          <struct>
                            <member>
                              <name>arch</name>
                              <value>
                                <string>noarch</string>
                              </value>
                            </member>
                            <member>
                              <name>type</name>
                              <value>
                                <string>maven</string>
                              </value>
                            </member>
                          </struct>
                        </value>
                      </member>
                      <member>
                        <name>components</name>
                        <value>
                          <array>
                            <data />
                          </array>
                        </value>
                      </member>
                      <member>
                        <name>content_generator</name>
                        <value>
                          <struct>
                            <member>
                              <name>name</name>
                              <value>
                                <string>test-cg</string>
                              </value>
                            </member>
                            <member>
                              <name>version</name>
                              <value>
                                <string>1.0</string>
                              </value>
                            </member>
                          </struct>
                        </value>
                      </member>
                      <member>
                        <name>host</name>
                        <value>
                          <struct>
                            <member>
                              <name>os</name>
                              <value>
                                <string>linux</string>
                              </value>
                            </member>
                            <member>
                              <name>arch</name>
                              <value>
                                <string>x86_64</string>
                              </value>
                            </member>
                          </struct>
                        </value>
                      </member>
                      <member>
                        <name>id</name>
                        <value>
                          <int>1</int>
                        </value>
                      </member>
                    </struct>
                  </value>
                </data>
              </array>
            </value>
          </member>
          <member>
            <name>metadata_version</name>
            <value>
              <int>0</int>
            </value>
          </member>
        </struct>
      </value>
    </param>
    <param>
      <value>
        <string>mydir</string>
      </value>
    </param>
  </params>
</methodCall>
'''


try:
	print xmlrpclib.loads(DATA)
except xmlrpclib.ResponseError as e:
	print e
